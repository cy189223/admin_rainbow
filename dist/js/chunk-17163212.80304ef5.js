(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-17163212"],{5413:function(t,e,i){},"5c49":function(t,e,i){},6566:function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"list"},[e("div",{staticClass:"content-head",staticStyle:{"margin-bottom":"20px"}},[e("div",{staticClass:"sort-keys"},[e("div",{staticClass:"tab-list"},t._l(t.statusList,(function(i,s){return e("div",{staticClass:"item",class:{actived:t.status===i.key},on:{click:function(e){t.status=i.key}}},[t._v("\n             "+t._s(i.text)+"\n             ("+t._s(t.statusTotal[i.key])+")\n           ")])})),0),e("a-input-search",{staticStyle:{width:"180px","margin-right":"10px"},attrs:{placeholder:"输入关键字","enter-button":"",allowClear:"",size:t.size},on:{input:t.onSearch,search:t.onSearch},model:{value:t.key,callback:function(e){t.key=e},expression:"key"}}),e("router-link",{staticStyle:{margin:"0px 10px"},attrs:{to:"/activity/pk/setting"}},[t._v("规则配置")])],1),t.selectMode?t._e():e("a-button",{attrs:{type:"primary",icon:"plus"},on:{click:t.handleCreate}},[t._v("创建"+t._s(t.resourceTypeText))])],1),e("a-table",{staticClass:"table",attrs:{rowKey:function(t){return t.uuid},dataSource:t.list,pagination:t.pagination,size:t.size}},[e("a-table-column",{attrs:{title:"标题",width:"240px"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("div",{staticClass:"title-c"},[e("img",{staticClass:"thumb",attrs:{src:i.thumb}}),e("div",{staticClass:"right"},[e("div",{staticClass:"title"},[t._v(t._s(i.title))]),e("PriceDisplay",{attrs:{info:i}})],1)])]}}])}),e("a-table-column",{attrs:{title:"分类",width:"80px"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("div",[t._v(t._s(1==i.type?"全局赏":"PK赏"))])]}}])}),e("a-table-column",{attrs:{title:"已开箱数",width:"100px"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("a",{attrs:{href:"javascript:;"},on:{click:function(e){return t.handleShowPackageSku(i)}}},[e("span",[t._v("已开"+t._s(i.rooms_count)+"箱")])])]}}])}),e("a-table-column",{attrs:{title:"奖品池",width:"280px"},scopedSlots:t._u([{key:"default",fn:function(i){return[[t._l(i.sku_cate,(function(s,a){return 1==i.type?e("div",{staticStyle:{"margin-bottom":"4px"}},[e("span",{staticClass:"level-title",staticStyle:{"margin-right":"10px"}},[t._v(t._s("N"==a?"全局奖品":"A"==a?"保底奖品":"串串奖励"))]),e("a",{attrs:{href:"javascript:;"},on:{click:function(e){return t.handleEditSkuList(i,a)}}},[e("span",{},[t._v(t._s(s.sku_total)+"种奖品")])])]):t._e()})),t._l(i.sku_cate,(function(s,a){return 2==i.type?e("div",{staticStyle:{"margin-bottom":"4px"}},[e("span",{staticClass:"level-title",staticStyle:{"margin-right":"10px"}},[t._v(t._s("N"==a?"全局奖品":"A"==a?"A阵营保底奖品":"B阵营保底奖品"))]),e("a",{attrs:{href:"javascript:;"},on:{click:function(e){return t.handleEditSkuList(i,a)}}},[e("span",{},[t._v(t._s(s.sku_total)+"种奖品")])])]):t._e()}))]]}}])}),t.selectMode?t._e():e("a-table-column",{attrs:{title:"排序",width:"80px"},scopedSlots:t._u([{key:"default",fn:function(i){return[t._v("\n\t\t\t    "+t._s(i.list_weight)+"\n\t\t\t    "),e("span",{staticStyle:{"margin-left":"10px"},on:{click:function(e){return t.handleEditListWeight(i)}}},[e("a",{attrs:{href:"javascript:;"}},[e("a-icon",{attrs:{type:"edit"}})],1)])]}}],null,!1,3923512274)}),t.selectMode?t._e():e("a-table-column",{attrs:{title:"上/下架",width:"60px"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("ISwitch",{attrs:{value:i.status,active:1,unactive:0},on:{change:function(e){return t.listedStatusChange(e,i)}}})]}}],null,!1,1077108743)}),e("a-table-column",{attrs:{title:"创建日期",width:"100px"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("span",[t._v(t._s(t.$tool.showShortTime(i.created_at)))])]}}])}),t.selectMode?t._e():e("a-table-column",{attrs:{title:"操作",width:"180px"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("span",[e("a",{attrs:{href:"javascript:;"},on:{click:function(e){return t.handleEdit(i)}}},[t._v("编辑")]),e("div",{staticStyle:{"margin-top":"10px"}},[e("a",{attrs:{href:"javascript:;"},on:{click:function(e){return t.handleDelete(i)}}},[t._v("删除")])])])]}}],null,!1,2511650327)})],1),e("a-modal",{staticStyle:{top:"100px"},attrs:{title:t.resourceTypeText+"详情",visible:t.isEdit,width:"1000px",footer:null},on:{cancel:function(e){t.isEdit=!1}}},[t.isEdit?e("Edit",{attrs:{uuid:t.editUuid},on:{cancel:function(e){t.isEdit=!1},success:t.fetchData}}):t._e()],1),t.isShowUserList?e("UserList",{attrs:{list:t.itemList,uuid:t.editUuid},on:{refresh:t.fetchData,close:function(e){t.isShowUserList=!1}}}):t._e(),t.isShowPlaceList?e("PlaceList",{attrs:{list:t.itemList,uuid:t.editUuid},on:{refresh:t.fetchData,close:function(e){t.isShowPlaceList=!1}}}):t._e(),t.isEditSkuList?e("EditSkuList",{attrs:{info:t.current,currentSkuLevel:t.currentSkuLevel},on:{refresh:t.fetchData,close:function(e){t.isEditSkuList=!1}}}):t._e(),t.isEditPackageSku?e("EditPackageSku",{attrs:{info:t.current,uuid:t.editUuid},on:{refresh:t.fetchData,close:function(e){t.isEditPackageSku=!1}}}):t._e()],1)},a=[],n=(i("8e6e"),i("ac6a"),i("456d"),i("ade3")),r=(i("c1df"),i("7cc6")),c=function(){var t=this,e=t._self._c;return e("div",{staticClass:"container"},[e("a-tabs",{attrs:{"default-active-key":"1"}},[e("a-tab-pane",{key:"1",attrs:{tab:"基础设置"}},[e("IForm",{staticClass:"form-container",attrs:{formFrame:t.frameBase,formData:t.form},on:{"update:formData":function(e){t.form=e},"update:form-data":function(e){t.form=e}}})],1)],1),e("div",{staticStyle:{display:"flex","justify-content":"flex-end"},attrs:{slot:"action"},slot:"action"},[e("a-button",{staticClass:"btn",on:{click:t.cancel}},[t._v("取消")]),e("a-button",{staticClass:"btn",attrs:{type:"primary"},on:{click:t.submit}},[t._v("提交")])],1)],1)},o=[],u=i("b0a5");function l(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,s)}return i}function p(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?l(Object(i),!0).forEach((function(e){Object(n["a"])(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):l(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var d="pks",h={components:{IForm:u["a"]},data:function(){return{form:{},categoryList:[]}},props:{uuid:{type:String}},computed:{categoryOptions:function(){return this.categoryList.map((function(t){return{title:t.title,value:t.id}}))},frameBase:function(){return[{title:"活动标题",key:"title",newline:!0,required:!0},{title:"封面",key:"thumb",type:"image",tips:"800*800",isShowImageTips:!1,newline:!0,sizeLimit:200},{title:"分类",key:"type",type:"radio",default:"yfs",required:!0,options:[{title:"全局赏",value:1},{title:"PK",value:2}],tips:' <span style="color:red;">创建后不可更改</span>',disabled:this.uuid,newline:!0},{title:"串串奖励",type:"number",input_width:"40px",key:"join_num",placeholder:"",default:0,prefix:"玩家一局内购买单发获得",suffix:"个以上全局奖品额外赠送奖品",tips:' 0为不使用串串奖励，<span style="color:red;">创建后不可更改</span>',disabled:this.uuid,where:{type:1}},{title:"参与人数",key:"person_num",type:"number",newline:!0,disabled:this.uuid,where:{type:1},required:!0,tips:' <span style="color:red;">创建后不可更改</span>'},{title:"A阵营人数",key:"person_num",type:"number",newline:!0,disabled:this.uuid,where:{type:2},required:!0},{title:"售价",key_prefix:"",type:"mix_price",newline:!0,where:{type:1}},{title:"A阵营售价",key_prefix:"",type:"mix_price",newline:!0,where:{type:2}},{title:"B阵营售价",key_prefix:"other_",type:"mix_price",newline:!0,where:{type:2}},{title:"标签",key:"tags",type:"tags",tips:"在列表标题下方显示，如“热卖新品”等短语。 填写多个仅显示第一个",newline:!0}]},frameUI:function(){var t;return[{title:"机柜主题风格",key:"theme",type:"radio",default:1,tips:"当前仅默认主题可用",options:[{title:"默认主题",value:1}],newline:!0,required:!0},(t={title:"页面背景图",key:"bg_image",tips:"不上传则使用默认图",isShowImageTips:!1},Object(n["a"])(t,"tips","1000 * 2160，不上传则使用默认图"),Object(n["a"])(t,"type","image"),Object(n["a"])(t,"newline",!0),t),{title:"机柜图",key:"body_image",tips:"750*1200, 参考图片规范包中扭蛋机机身图, 不上传则使用默认",isShowImageTips:!1,type:"image",newline:!0},{title:"扭1次按钮",key:"btn_1",tips:"200*80, 参考图片规范包中对应图片, 不上传则使用默认",isShowImageTips:!1,type:"image",newline:!0},{title:"扭1次按钮（按下）",key:"btn_1_on",tips:"200*80, 参考图片规范包中对应图片, 不上传则使用默认",isShowImageTips:!1,type:"image",newline:!0},{title:"扭5次按钮",key:"btn_5",tips:"126*66, 参考图片规范包中对应图片, 不上传则使用默认",isShowImageTips:!1,type:"image",newline:!0},{title:"扭5次按钮（按下）",key:"btn_5_on",tips:"126*66, 参考图片规范包中对应图片, 不上传则使用默认",isShowImageTips:!1,type:"image",newline:!0},{title:"试一试按钮",key:"btn_try",tips:"126*66, 参考图片规范包中对应图片, 不上传则使用默认",isShowImageTips:!1,type:"image",newline:!0},{title:"试一试按钮（按下）",key:"btn_try_on",tips:"126*66, 参考图片规范包中对应图片, 不上传则使用默认",isShowImageTips:!1,type:"image",newline:!0}]}},created:function(){},mounted:function(){this.uuid=this.uuid||this.$route.params.uuid,this.initForm()},watch:{uuid:function(){this.initForm()}},methods:{initForm:function(){var t=this;this.uuid?this.$http("/".concat(d,"/").concat(this.uuid)).then((function(e){t.form=e.data.info})):this.form=p({},this.$initForm(this.frameBase))},cancel:function(){this.uuid="",this.$emit("cancel")},create:function(){var t=this;this.$http.post("/".concat(d),p(p({},this.form),{},{status:0,list_weight:999})).then((function(e){t.$message.success("创建成功"),t.$emit("success")}))},update:function(){var t=this;this.$http.patch("/".concat(d,"/").concat(this.uuid),{type:"update",attributes:this.form}).then((function(e){t.$message.success("更新成功"),t.$emit("success")}))},submit:function(){this.uuid?this.update():this.create()}}},f=h,_=(i("fd7a"),i("2877")),m=Object(_["a"])(f,c,o,!1,null,"6684d1c4",null),y=m.exports,g=(i("7f7f"),function(){var t=this,e=t._self._c;return e("a-modal",{staticStyle:{top:"100px"},attrs:{title:t.list.user&&t.list.user.name||"",visible:!0,width:"1100px"},on:{cancel:t.handleCancel}},[e("a-table",{staticClass:"product-table table",attrs:{pagination:t.pagination,rowKey:function(t){return t.id},dataSource:t.list.packages,bordered:"",size:"small"}},[e("a-table-column",{attrs:{title:"序号",width:"20px"},scopedSlots:t._u([{key:"default",fn:function(i,s,a){return[e("div",[t._v(t._s(a+1))])]}}])}),e("a-table-column",{key:"thumb",attrs:{title:"奖品",width:"80px"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("div",{staticStyle:{display:"flex","align-items":"center"}},[e("img",{staticClass:"thumb",staticStyle:{"margin-right":"10px"},attrs:{src:i.thumb}}),e("div",[t._v("\n\t\t  \t\t\t"+t._s(i.title)+" "),e("br"),t._v("\n\t\t  \t\t\t"+t._s(i.number)+"\n\t\t  \t\t")])])]}}])}),e("a-table-column",{attrs:{title:"详情",width:"150px"},scopedSlots:t._u([{key:"default",fn:function(i){return[i.assets?e("div",[i.assets.score?e("span",[t._v("\n\t\t\t\t  积分："+t._s(i.assets.score)+";\n\t\t\t\t")]):t._e(),i.assets.redpack?e("span",[t._v("\n\t\t\t\t  红包："+t._s(i.assets.redpack)+";\n\t\t\t\t")]):t._e(),i.assets.show_box_card?e("span",[t._v("\n\t\t\t\t  显示卡："+t._s(i.assets.show_box_card)+";\n\t\t\t\t")]):t._e(),i.assets.exclude_box_card?e("span",[t._v("\n\t\t\t\t  排除卡："+t._s(i.assets.exclude_box_card)+";\n\t\t\t\t")]):t._e(),i.assets.level_score?e("span",[t._v("\n\t\t\t\t  成长值："+t._s(i.assets.level_score)+";\n\t\t\t\t")]):t._e()]):t._e()]}}])})],1),e("template",{slot:"footer"},[e("div",{staticClass:"btn-c"},[e("div",{staticStyle:{"flex-grow":"1"}}),e("a-button",{key:"back",on:{click:t.handleCancel}},[t._v("关闭")])],1)])],2)}),v=[],k=i("7971"),b=i("e37f"),S={components:{UploadImages:k["a"],iSwitch:r["a"],IDatePicker:b["a"]},props:{uuid:{type:String,default:function(){return""}},list:{type:Object,default:function(){return{}}}},data:function(){return{type:"all",per_page:10,page:1,total:0,session:"current",customSession:"",joinDay:""}},watch:{},created:function(){console.log(this.list)},computed:{pagination:function(){var t=this;return{defaultPageSize:this.per_page,defaultCurrent:this.page,total:this.total,onChange:function(e){console.log(e),t.page=e,t.initList()}}}},methods:{initList:function(){var t=this;this.$http.get("/lotteries/".concat(this.uuid,"/users"),{params:{type:this.type,page:this.page,session:this.customSession||this.session,join_day:this.joinDay,per_page:this.per_page}}).then((function(e){t.total=e.data.item_total,t.list=e.data.list}))},handleCancel:function(){this.$emit("refresh"),this.$emit("close")},handleSave:function(){this.$emit("refresh"),this.$emit("close")},handleDelete:function(t){var e=this;this.$http.delete("/activities/".concat(this.uuid,"/skus/").concat(t.uuid)).then((function(t){e.$message.success("删除成功"),e.initList()}))}}},w=S,x=(i("8188"),Object(_["a"])(w,g,v,!1,null,"b747d1c0",null)),L=x.exports,O=function(){var t=this,e=t._self._c;return e("a-modal",{staticStyle:{top:"100px"},attrs:{title:t.list.type+("A"==t.list.type?t.list.seat_code:"阵营")+(t.list.user&&t.list.user.name||""),visible:!0,width:"1100px"},on:{cancel:t.handleCancel}},[e("a-table",{staticClass:"product-table table",attrs:{pagination:t.pagination,rowKey:function(t){return t.id},dataSource:t.list.skus,bordered:"",size:"small"}},[e("a-table-column",{attrs:{title:"序号",width:"20px"},scopedSlots:t._u([{key:"default",fn:function(i,s,a){return[e("div",[t._v(t._s(a+1))])]}}])}),e("a-table-column",{key:"thumb",attrs:{title:"奖品",width:"80px"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("div",{staticStyle:{display:"flex","align-items":"center"}},[e("img",{staticClass:"thumb",staticStyle:{"margin-right":"10px"},attrs:{src:i.sku.thumb}}),e("div",[t._v("\n\t\t  \t\t\t"+t._s(i.sku.title)+" "),e("br"),t._v("\n\t\t  \t\t\t"+t._s(i.sku.number)+"\n\t\t  \t\t")])])]}}])}),e("a-table-column",{attrs:{title:"详情",width:"150px"},scopedSlots:t._u([{key:"default",fn:function(i){return[i.sku.assets?e("div",[i.sku.assets.score?e("span",[t._v("\n\t\t\t\t  积分："+t._s(i.sku.assets.score)+";\n\t\t\t\t")]):t._e(),i.sku.assets.redpack?e("span",[t._v("\n\t\t\t\t  红包："+t._s(i.sku.assets.redpack)+";\n\t\t\t\t")]):t._e(),i.sku.assets.show_box_card?e("span",[t._v("\n\t\t\t\t  显示卡："+t._s(i.sku.assets.show_box_card)+";\n\t\t\t\t")]):t._e(),i.sku.assets.exclude_box_card?e("span",[t._v("\n\t\t\t\t  排除卡："+t._s(i.sku.assets.exclude_box_card)+";\n\t\t\t\t")]):t._e(),i.sku.assets.level_score?e("span",[t._v("\n\t\t\t\t  成长值："+t._s(i.sku.assets.level_score)+";\n\t\t\t\t")]):t._e()]):t._e()]}}])})],1),e("template",{slot:"footer"},[e("div",{staticClass:"btn-c"},[e("div",{staticStyle:{"flex-grow":"1"}}),e("a-button",{key:"back",on:{click:t.handleCancel}},[t._v("关闭")])],1)])],2)},j=[],C={components:{UploadImages:k["a"],iSwitch:r["a"],IDatePicker:b["a"]},props:{uuid:{type:String,default:function(){return""}},list:{type:Object,default:function(){return{}}}},data:function(){return{type:"all",per_page:10,page:1,total:0,session:"current",customSession:"",joinDay:""}},watch:{},created:function(){console.log(this.list)},computed:{pagination:function(){var t=this;return{defaultPageSize:this.per_page,defaultCurrent:this.page,total:this.total,onChange:function(e){console.log(e),t.page=e,t.initList()}}}},methods:{initList:function(){var t=this;this.$http.get("/lotteries/".concat(this.uuid,"/users"),{params:{type:this.type,page:this.page,session:this.customSession||this.session,join_day:this.joinDay,per_page:this.per_page}}).then((function(e){t.total=e.data.item_total,t.list=e.data.list}))},handleCancel:function(){this.$emit("refresh"),this.$emit("close")},handleSave:function(){this.$emit("refresh"),this.$emit("close")},handleDelete:function(t){var e=this;this.$http.delete("/activities/".concat(this.uuid,"/skus/").concat(t.uuid)).then((function(t){e.$message.success("删除成功"),e.initList()}))}}},P=C,$=(i("9e38"),Object(_["a"])(P,O,j,!1,null,"5ae0f7b6",null)),D=$.exports,E=function(){var t=this,e=t._self._c;return e("a-modal",{staticStyle:{top:"100px"},attrs:{title:t.title,visible:!0,width:"1100px"},on:{cancel:t.handleCancel}},[e("div",{staticClass:"tips"}),e("a-table",{staticClass:"product-table",attrs:{rowKey:function(t){return t.id},dataSource:t.list,bordered:"",pagination:!1,size:"small"}},[e("a-table-column",{attrs:{title:"序号",width:"20px"},scopedSlots:t._u([{key:"default",fn:function(i,s,a){return[e("div",[t._v(t._s(a+1))])]}}])}),e("a-table-column",{key:"thumb",attrs:{title:"图片",width:"80px"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("div",{staticStyle:{display:"flex","align-items":"center"}},[e("img",{staticClass:"thumb",staticStyle:{"margin-right":"10px"},attrs:{src:i.thumb}}),e("div",[t._v("\n\t\t\t\t\t\t\t"+t._s(i.title)+" "),e("br"),t._v("\n\t\t\t\t\t\t\t"+t._s(i.number)+"\n\t\t\t\t\t\t")])])]}}])}),e("a-table-column",{key:"number",attrs:{title:"类型",width:"100px"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("div",[t._v(t._s("A"==i.prize_type?"A阵营保底":"B"==i.prize_type?"B阵营保底":"全局奖品"))])]}}])}),e("a-table-column",{key:"number",attrs:{title:"价值",width:"100px"},scopedSlots:t._u([{key:"default",fn:function(t){return[e("div",[e("PriceDisplay",{attrs:{info:t}})],1)]}}])}),e("a-table-column",{attrs:{title:"SKU类型",width:"80px"},scopedSlots:t._u([{key:"default",fn:function(t){return[e("ISkuType",{attrs:{info:t}})]}}])}),e("a-table-column",{attrs:{title:"操作",width:"80px"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("a",{attrs:{href:"javascript:;"},on:{click:function(e){return t.handleEdit(i)}}},[t._v("编辑")]),e("a-divider",{attrs:{type:"vertical"}}),e("a",{attrs:{href:"javascript:;"},on:{click:function(e){return t.handleDelete(i)}}},[t._v("删除")])]}}])})],1),e("template",{slot:"footer"},[e("div",{staticClass:"btn-c"},[0==t.list.length||"N"==this.currentSkuLevel?e("a-button",{staticClass:"add",attrs:{type:"primary"},on:{click:t.handleCreate}},[t._v("\n\t\t\t\t\t新增一款\n\t\t\t\t")]):t._e(),e("div",{staticStyle:{"flex-grow":"1"}}),e("a-button",{key:"back",on:{click:t.handleCancel}},[t._v("关闭")])],1)])],2)},U=[],I=i("c685");function T(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,s)}return i}function z(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?T(Object(i),!0).forEach((function(e){Object(n["a"])(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):T(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var A={components:{UploadImages:k["a"],iSwitch:r["a"],ISkuType:I["a"]},props:{info:{type:Object,default:function(){return{}}},currentSkuLevel:{type:String,default:function(){return""}}},data:function(){return{list:[],frame:[{title:"SKU类型",key:"sku_type",type:"radio",default:1,required:!0,span:24,options:[{title:"无绑定",value:1},{title:"绑定商城中的商品",value:2},{title:"平台虚拟资产",value:3}],tips:""},{title:"绑定商品",key:"product_id",type:"product_id",auto_fill_fields:{title:"title",thumb:"thumb",number:"number",money_price:"money_price",score_price:"score_price"}},{title:"绑定虚拟资产",key:"assets",type:"assets",where:{sku_type:3}},{title:"奖品名称",key:"title",required:!0,placeholder:'如"积分礼包1"'},{title:"编号",key:"number",placeholder:"可填写编号方便在订单中对应货物"},{title:"封面",key:"thumb",type:"image"},{title:"价值",key_prefix:"",type:"mix_price",tips:"价值用于返售时作为返售原价进行折扣计算",newline:!0,required:!0}]}},computed:{title:function(){return console.log(this.info,this.currentSkuLevel),1==this.info.type?"N"==this.currentSkuLevel?"全局奖品":"A"==this.currentSkuLevel?"保底奖品":"串串奖励":"N"==this.currentSkuLevel?"全局奖品":"A"==this.currentSkuLevel?"A阵营保底奖品":"B阵营保底奖品"}},watch:{uuid:function(){this.initList()}},created:function(){this.initList()},methods:{initList:function(){var t=this;this.$http.get("/pks/".concat(this.info.uuid,"/skus"),{params:{prize_type:this.currentSkuLevel,activity_id:this.info.id}}).then((function(e){t.list=e.data.list}))},handleCreate:function(){var t=this;this.$iForm.show({title:"新增活动奖品",frame:this.frame,success:function(e){t.$http.post("/pks/".concat(t.info.uuid,"/skus"),z(z({},e),{},{activity_id:t.info.id,prize_type:t.currentSkuLevel})).then((function(e){t.initList(),t.$iForm.hide()}))}})},handleEdit:function(t){var e=this;this.$iForm.show({title:"编辑活动奖品",frame:this.frame,form:t,success:function(i){e.$http.put("/pk/skus/".concat(t.uuid),{type:"update",attributes:z(z({},i),{},{activity_id:e.info.id})}).then((function(t){e.initList(),e.$iForm.hide()}))}})},handleCancel:function(){this.$emit("refresh"),this.$emit("close")},handleSave:function(){this.$emit("refresh"),this.$emit("close")},handleDelete:function(t){var e=this;this.$confirm({title:"提示",content:"确认删除吗？",onOk:function(){e.$http.delete("/pk/skus/".concat(t.uuid)).then((function(t){e.$message.success("删除成功"),e.initList()}))}})}}},F=A,q=(i("a3a4"),Object(_["a"])(F,E,U,!1,null,"090769f7",null)),B=q.exports,K=function(){var t=this,e=t._self._c;return e("a-modal",{staticStyle:{top:"100px"},attrs:{title:"所有抽取记录(".concat(this.total,"条)"),visible:!0,width:"1000px"},on:{cancel:t.handleCancel}},[e("a-table",{staticClass:"product-table",attrs:{rowKey:function(t){return t.id},dataSource:t.list,bordered:"",pagination:t.pagination,size:"small"}},[e("a-table-column",{key:"title",attrs:{title:"序号",width:"40px"},scopedSlots:t._u([{key:"default",fn:function(i,s,a){return[e("span",[t._v("\n            第"+t._s(t.total-(t.page-1)*t.perPage-a)+"箱\n          ")])]}}])}),e("a-table-column",{attrs:{title:"开箱时间",width:"110px"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("div",{staticClass:"title-c"},[t._v(t._s(i.created_at))])]}}])}),e("a-table-column",{attrs:{title:"结束时间",width:"110px"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("div",{staticClass:"title-c"},[t._v(t._s(i.completetime))])]}}])}),e("a-table-column",{attrs:{title:"状态",width:"40px"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("div",{staticClass:"title-c"},[t._v(t._s(1==i.status?"进行中":"已开奖"))])]}}])}),e("a-table-column",{attrs:{width:"280px"},scopedSlots:t._u([{key:"default",fn:function(i){return t._l(i.users,(function(s,a){return e("div",{key:s.uuid},[2==i.status?e("div",{staticStyle:{"margin-bottom":"4px",display:"flex"}},[e("span",{staticClass:"level-title",staticStyle:{"margin-right":"10px"}},[t._v(t._s(s.type)+t._s("A"==s.type?s.seat_code:"阵营"))]),s.user?e("span",{staticClass:"level-title",staticStyle:{"margin-right":"10px"}},[t._v("进房时间："+t._s(s.jointime))]):t._e(),s.user?e("div",{staticClass:"user-info-content",staticStyle:{"margin-right":"10px"}},[e("img",{staticClass:"headimg",attrs:{src:s.user.headimg,alt:""}}),e("div",{staticClass:"user-ame"},[t._v(t._s(s.user.name))])]):t._e(),s.packages.length>0?e("a",{attrs:{href:"javascript:;"},on:{click:function(e){return t.showUserList(s)}}},[e("span",{},[t._v(t._s(s.packages.length)+"个奖品")])]):t._e(),2==i.status&&0==s.packages.length?e("span",[t._v("未中奖")]):t._e()]):t.ifHasUser(i.users)?e("div",{staticStyle:{"margin-bottom":"4px",display:"flex"}},[e("span",{staticClass:"level-title",staticStyle:{"margin-right":"10px"}},[t._v(t._s(s.type)+t._s("A"==s.type?s.seat_code:"阵营"))]),s.user?e("span",{staticClass:"level-title",staticStyle:{"margin-right":"10px"}},[t._v("进房时间："+t._s(s.jointime))]):t._e(),s.user?e("div",{staticClass:"user-info-content",staticStyle:{"margin-right":"10px"}},[e("img",{staticClass:"headimg",attrs:{src:s.user.headimg,alt:""}}),e("div",{staticClass:"user-ame"},[t._v(t._s(s.user.name))])]):t._e(),s.skus.length>0?e("a",{attrs:{href:"javascript:;"},on:{click:function(e){return t.showPlaceList(s)}}},[e("span",{},[t._v(t._s(s.skus.length)+"个奖品")])]):t._e(),2==i.status&&0==s.packages.length?e("span",[t._v("未中奖")]):t._e()]):t._e()])}))}}])},[e("div",{attrs:{slot:"title"},slot:"title"},[t._v("\n\t\t\t\t\t详情\n\t\t\t\t")])])],1),e("template",{slot:"footer"},[e("div",{staticClass:"btn-c"},[e("div",{staticStyle:{"flex-grow":"1"}}),e("a-button",{key:"back",on:{click:t.handleCancel}},[t._v("关闭")])],1)]),t.isShowUserList?e("UserList",{attrs:{list:t.itemList,uuid:t.editUuid},on:{close:function(e){t.isShowUserList=!1}}}):t._e(),t.isShowPlaceList?e("PlaceList",{attrs:{list:t.itemList,uuid:t.editUuid},on:{close:function(e){t.isShowPlaceList=!1}}}):t._e()],2)},M=[],N={components:{UploadImages:k["a"],iSwitch:r["a"],PlaceList:D,UserList:L},props:{uuid:{type:String,default:function(){return""}},info:{type:Object,default:function(){return{}}}},data:function(){return{list:[],page:1,perPage:15,total:0,isShowPlaceList:!1,isShowUserList:!1}},watch:{uuid:function(){this.initList()}},created:function(){this.initList()},computed:{pagination:function(){var t=this;return{defaultPageSize:this.perPage,defaultCurrent:this.page,total:this.total,onChange:function(e){t.page=e,t.initList()}}}},methods:{showUserList:function(t){this.editUuid=t.uuid,this.itemList=t,this.isShowUserList=!0},showPlaceList:function(t){this.editUuid=t.uuid,this.itemList=t,this.isShowPlaceList=!0,console.log(this.itemList,this.isShowPlaceList)},ifHasUser:function(t){for(var e=0,i=t.length;e<i;e++){var s=t[e];if(s.user)return!0}return!1},initList:function(){var t=this;this.$http.get("/pk-rooms/".concat(this.uuid),{params:{page:this.page,per_page:this.perPage}}).then((function(e){t.list=e.data.list,t.total=e.data.item_total}))},handleCancel:function(){this.$emit("refresh"),this.$emit("close")},handleSave:function(){this.$emit("refresh"),this.$emit("close")},handleDelete:function(t){var e=this;this.$http.delete("/activities/".concat(this.uuid,"/skus/").concat(t.uuid)).then((function(t){e.$message.success("删除成功"),e.initList()}))}}},H=N,J=(i("c610"),Object(_["a"])(H,K,M,!1,null,"10f8f2c6",null)),W=J.exports;function G(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,s)}return i}function Q(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?G(Object(i),!0).forEach((function(e){Object(n["a"])(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):G(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var R="pks",V="拳击",X={components:{ISwitch:r["a"],Edit:y,UserList:L,PlaceList:D,EditSkuList:B,EditPackageSku:W},props:{selectMode:{type:Boolean},params:{type:Object},size:{type:String,default:"default"},type:{type:String,default:""}},data:function(){var t;return t={itemList:[],isEdit:!1,editUuid:"",current:{},isEditSkuLevel:!1,isEditSkuList:!1,currentSkuLevel:1,resourceTypeText:V,exportOptions:{status:"all",startTime:"",endTime:"",type:"normal"},status:"unexpired",list:[],page:1,per_page:10,total:0,key:"",category_id:void 0,statusList:[{text:"上架中",key:"on_stock"},{text:"已下架",key:"off_stock"},{text:"售罄",key:"sell_out"}]},Object(n["a"])(t,"status","on_stock"),Object(n["a"])(t,"statusTotal",{on_stock:0,off_stock:0,sell_out:0,marked:0}),Object(n["a"])(t,"isShowUserList",!1),Object(n["a"])(t,"isShowPlaceList",!1),Object(n["a"])(t,"isEditPackageSku",!1),t},watch:{params:function(){this.refreshData()},category_id:function(){this.refreshData()},type:function(){this.refreshData()},status:function(){this.page=1,this.refreshData()}},computed:{pagination:function(){var t=this;return{defaultPageSize:this.per_page,defaultCurrent:this.page,total:this.total,onChange:function(e){t.page=e,t.fetchData()}}}},filters:{},created:function(){this.fetchData()},methods:{handleShowPackageSku:function(t){this.editUuid=t.uuid,this.current=t,this.isEditPackageSku=!0},showPlaceList:function(t){this.editUuid=t.uuid,this.itemList=t,this.isShowPlaceList=!0,console.log(this.itemList,this.isShowPlaceList)},showUserList:function(t){this.editUuid=t.uuid,this.itemList=t,this.isShowUserList=!0},handleEdit:function(t){console.log(t),this.editUuid=t.uuid,this.isEdit=!0,this.$http("/pks/".concat(t.uuid)).then((function(t){console.log(t)}))},fetchTotalData:function(){var t=this;this.$http("/status-total/activity/pk").then((function(e){t.statusTotal=e.data.total}))},handleEditSkuList:function(t,e){this.current=t,this.currentSkuLevel=e,this.isEditSkuList=!0},getPath:function(t){this.$getPathPopup.show({page:"/pages/fudai/detail",param:"uuid="+t.uuid})},handleDelete:function(t){var e=this;this.$confirm({title:"提示",content:"确认删除吗？",onOk:function(){e.$http.delete("/".concat(R,"/").concat(t.uuid)).then((function(t){e.fetchData()}))}})},updateItem:function(t,e){return this.$http.patch("/".concat(R,"/").concat(t.uuid),{type:"update",attributes:Q({},e)})},listedStatusChange:function(t,e){var i=this;this.updateItem(e,{status:t}).then((function(t){i.fetchData()}))},handleEditSkuLevel:function(t){this.current=t,this.isEditSkuLevel=!0},handleEditListWeight:function(t){var e=this;this.$globalForm.show({title:"编辑排序",items:[{type:"number",key:"list_weight",title:"排序",default:t.list_weight,required:!0}],success:function(i){e.updateItem(t,Q({},i)).then((function(t){e.$message.success("保存成功"),e.$globalForm.hide(),e.fetchData()}))}})},handleCreate:function(){this.editUuid="",this.isEdit=!0},refreshData:function(){this.page=1,this.key="",this.fetchData()},onSearch:function(t){this.page=1,this.fetchData()},fetchData:function(){var t=this;this.isEdit=!1,this.$http.get("/".concat(R),{params:Q(Q({status:this.status},this.params),{},{page:this.page,per_page:this.per_page,key:this.key,category_id:this.category_id})}).then((function(e){t.list=e.data.list,t.total=e.data.item_total})).finally((function(){t.fetchTotalData(),t.loading=!1}))},getCategoryList:function(){var t=this;this.$api.emit("category.list","article").then((function(e){t.category=e.data.list}))}}},Y=X,Z=(i("ad01"),Object(_["a"])(Y,s,a,!1,null,"4eeed866",null));e["default"]=Z.exports},8188:function(t,e,i){"use strict";i("8da2")},"8da2":function(t,e,i){},"92dc":function(t,e,i){},"9e38":function(t,e,i){"use strict";i("5c49")},a3a4:function(t,e,i){"use strict";i("d47a")},ad01:function(t,e,i){"use strict";i("92dc")},b0a5:function(t,e,i){"use strict";var s=i("b6c9");e["a"]=s["a"]},c610:function(t,e,i){"use strict";i("f8fc")},c685:function(t,e,i){"use strict";var s=function(){var t=this,e=t._self._c;return e("div",[1===t.info.sku_type?e("span",[t._v("-")]):2===t.info.sku_type?e("div",[t._v("\n    商城商品\n    "),t.info.product?e("div",[t._v("\n      【"+t._s(t.info.product.title)+"】\n    ")]):t._e()]):3===t.info.sku_type?e("span",[t._v("虚拟资产")]):t._e()])},a=[],n={name:"ISwitch",props:{info:{type:Object,default:function(){return{}}}},data:function(){return{}},watch:{},methods:{}},r=n,c=i("2877"),o=Object(c["a"])(r,s,a,!1,null,"c7676646",null);e["a"]=o.exports},d47a:function(t,e,i){},f8fc:function(t,e,i){},fd7a:function(t,e,i){"use strict";i("5413")}}]);