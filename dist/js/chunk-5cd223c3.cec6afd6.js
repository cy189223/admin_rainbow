(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5cd223c3"],{5118:function(t,e,i){(function(t){var a="undefined"!==typeof t&&t||"undefined"!==typeof self&&self||window,n=Function.prototype.apply;function s(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new s(n.call(setTimeout,a,arguments),clearTimeout)},e.setInterval=function(){return new s(n.call(setInterval,a,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},s.prototype.unref=s.prototype.ref=function(){},s.prototype.close=function(){this._clearFn.call(a,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout((function(){t._onTimeout&&t._onTimeout()}),e))},i("6017"),e.setImmediate="undefined"!==typeof self&&self.setImmediate||"undefined"!==typeof t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!==typeof self&&self.clearImmediate||"undefined"!==typeof t&&t.clearImmediate||this&&this.clearImmediate}).call(this,i("c8ba"))},6017:function(t,e,i){(function(t,e){(function(t,i){"use strict";if(!t.setImmediate){var a,n=1,s={},o=!1,r=t.document,c=Object.getPrototypeOf&&Object.getPrototypeOf(t);c=c&&c.setTimeout?c:t,"[object process]"==={}.toString.call(t.process)?f():h()?m():t.MessageChannel?g():r&&"onreadystatechange"in r.createElement("script")?v():_(),c.setImmediate=l,c.clearImmediate=u}function l(t){"function"!==typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),i=0;i<e.length;i++)e[i]=arguments[i+1];var o={callback:t,args:e};return s[n]=o,a(n),n++}function u(t){delete s[t]}function d(t){var e=t.callback,a=t.args;switch(a.length){case 0:e();break;case 1:e(a[0]);break;case 2:e(a[0],a[1]);break;case 3:e(a[0],a[1],a[2]);break;default:e.apply(i,a);break}}function p(t){if(o)setTimeout(p,0,t);else{var e=s[t];if(e){o=!0;try{d(e)}finally{u(t),o=!1}}}}function f(){a=function(t){e.nextTick((function(){p(t)}))}}function h(){if(t.postMessage&&!t.importScripts){var e=!0,i=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=i,e}}function m(){var e="setImmediate$"+Math.random()+"$",i=function(i){i.source===t&&"string"===typeof i.data&&0===i.data.indexOf(e)&&p(+i.data.slice(e.length))};t.addEventListener?t.addEventListener("message",i,!1):t.attachEvent("onmessage",i),a=function(i){t.postMessage(e+i,"*")}}function g(){var t=new MessageChannel;t.port1.onmessage=function(t){var e=t.data;p(e)},a=function(e){t.port2.postMessage(e)}}function v(){var t=r.documentElement;a=function(e){var i=r.createElement("script");i.onreadystatechange=function(){p(e),i.onreadystatechange=null,t.removeChild(i),i=null},t.appendChild(i)}}function _(){a=function(t){setTimeout(p,0,t)}}})("undefined"===typeof self?"undefined"===typeof t?this:t:self)}).call(this,i("c8ba"),i("f28c"))},"6a0a":function(t,e,i){"use strict";i.r(e);i("ac6a");var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"content-wrap"},[e("div",{staticClass:"content-head",staticStyle:{"margin-bottom":"20px"}},[e("div",{staticClass:"sort-keys"},[e("div",{staticClass:"tab-list"},t._l(t.statusList,(function(i,a){return e("div",{staticClass:"item",class:{actived:t.keys.status===i.key},on:{click:function(e){t.keys.status=i.key}}},[t._v("\n            "+t._s(i.text)+"\n            ("+t._s(t.statusTotal[i.key])+")\n            ")])})),0),e("a-input-search",{staticStyle:{width:"180px","margin-right":"10px"},attrs:{placeholder:"模糊搜索","enter-button":"",allowClear:"",size:t.size},on:{input:t.refresh,search:t.refresh},model:{value:t.keys.key,callback:function(e){t.$set(t.keys,"key",e)},expression:"keys.key"}}),e("a-select",{staticStyle:{width:"150px","margin-right":"10px"},attrs:{placeholder:"分类",allowClear:""},model:{value:t.keys.category_id,callback:function(e){t.$set(t.keys,"category_id",e)},expression:"keys.category_id"}},[t._l(t.allCategoryList,(function(i){return[e("a-select-opt-group",{key:i.id},[e("span",{attrs:{slot:"label"},slot:"label"},[t._v(t._s(i.title))]),t._l(i.sub_categories,(function(i){return e("a-select-option",{key:i.id,attrs:{value:i.id}},[t._v(t._s(i.title))])}))],2)]}))],2),e("a-input",{staticStyle:{width:"180px","margin-right":"10px"},attrs:{placeholder:"完整编号搜索",allowClear:""},model:{value:t.keys.number,callback:function(e){t.$set(t.keys,"number",e)},expression:"keys.number"}}),e("a-button",{staticStyle:{"margin-left":"30px",float:"right"},attrs:{type:"primary"},on:{click:function(e){t.isBatchEdit=!t.isBatchEdit}}},[e("span",[t._v("批量编辑")])])],1),e("a-button",{attrs:{type:"primary",icon:"plus"},on:{click:t.plusProducts}},[t._v("创建商品")])],1),e("a-table",{staticClass:"table",attrs:{rowKey:function(t){return t.uuid},dataSource:t.list,pagination:t.pagination}},[e("a-table-column",{attrs:{title:"主图",width:"60px"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("div",{staticClass:"product-info"},[e("div",{staticClass:"thumb",style:"background-image:url(".concat(i.thumb,"?x-oss-process=image/resize,w_400)")},[i.image_tag?e("img",{class:"tag-image location-"+i.image_tag.location,attrs:{src:i.image_tag.image+"?x-oss-process=image/resize,w_400"}}):t._e()])])]}}])}),e("a-table-column",{attrs:{title:"商品",width:"320px"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("div",{staticClass:"product-info"},[e("div",{staticClass:"info-meta"},[e("div",{staticClass:"title"},[e("span",[t._v(t._s(i.title))]),t._v(" \n                "),i.is_presell?e("a-tag",{attrs:{color:"orange"}},[t._v("预售")]):t._e(),0==i.status?e("a-tag",{attrs:{color:"red"}},[t._v("下架")]):t._e(),0===i.stock?e("a-tag",{attrs:{color:"red"}},[t._v("售罄")]):t._e(),e("a",{on:{click:function(e){return t.handleEditBaseInfo(i)}}},[t._v("\n                  编辑\n                  "),e("a-icon",{attrs:{type:"edit"}})],1)],1),e("div",{staticClass:"brand"},[e("span",{staticClass:"marked-tag",class:{actived:i.marked_at},on:{click:function(e){return t.markProduct(i)}}},[t._v("标记")]),i.brand?e("span",[t._v(t._s(i.brand.title))]):t._e(),i.categories&&i.categories.length?e("span",[t._v(" / "+t._s(t.getProductCategory(i.categories)))]):t._e(),i.number?e("span",[t._v(" / "+t._s(i.number))]):t._e(),i.supplier?e("span",[t._v(" / "+t._s(i.supplier))]):t._e()]),e("div",{staticClass:"price-c"},[e("PriceDisplay",{attrs:{info:i}})],1)])])]}}])}),e("a-table-column",{attrs:{title:"SKU库存",width:"140px"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("span",[t._v(t._s(i.skus_count)+" SKU")]),t._v(" \n          "),e("a",[e("a-icon",{attrs:{type:"edit"},on:{click:function(e){return t.handleEditSkus(i)}}})],1),e("div",{staticStyle:{"font-size":"13px"}},[e("span",[t._v("库存"+t._s(i.stock||0)+" 件")])])]}}])}),e("a-table-column",{attrs:{title:"销量",width:"120px"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("span",[t._v("已售 "+t._s(i.sales||0)+" 件")])]}}])}),e("a-table-column",{attrs:{title:"排序",width:"100px"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("div",[e("span",[t._v(t._s(i.list_weight||0)+" ")]),e("a-popover",{attrs:{title:"排序权重",trigger:"click"},model:{value:i.visible,callback:function(e){t.$set(i,"visible",e)},expression:"row.visible"}},[e("template",{slot:"content"},[e("div",{staticStyle:{display:"flex"}},[e("a-input",{staticStyle:{"margin-right":"10px",width:"120px"},attrs:{placeholder:"请输入",autofocus:"",size:"small"},model:{value:t.listWeight,callback:function(e){t.listWeight=e},expression:"listWeight"}}),e("a-button",{attrs:{type:"primary",size:"small",loading:t.loading3},on:{click:function(e){return t.handleUpdateListWeight(i)}}},[t._v("保存")])],1)]),e("span",[e("a",{attrs:{href:"javascript:;"}},[e("a-icon",{attrs:{type:"edit"}})],1)])],2)],1)]}}])}),e("a-table-column",{attrs:{title:"人群专享价",width:"110px"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("div",[i.group_prices_count?e("span",[t._v("已设置")]):e("span",[t._v("-")])]),e("div",[e("a",{attrs:{href:"javascript:;"},on:{click:function(e){return t.handleEditGroupPrice(i)}}},[t._v("编辑")])])]}}])}),e("a-table-column",{attrs:{title:"是否上架",width:"100px"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("ISwitch",{attrs:{value:i.status,active:1,unactive:0},on:{change:function(e){return t.productStatusChange(e,i)}}})]}}])}),e("a-table-column",{attrs:{title:"操作",width:"200px"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("span",[e("a",{attrs:{href:"javascript:;"},on:{click:function(e){return t.getPath(i)}}},[t._v("预览/路径")]),e("a-divider",{attrs:{type:"vertical"}}),e("a",{attrs:{href:"javascript:;"},on:{click:function(e){return t.handleEditProduct(i)}}},[t._v("编辑")]),e("a-divider",{attrs:{type:"vertical"}}),e("a-dropdown",[e("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[e("a-menu-item",{on:{click:function(e){return t.handleDelete(i)}}},[e("a",[t._v("删除")])])],1),e("a",[t._v("更多\n                "),e("a-icon",{attrs:{type:"down"}})],1)],1)],1)]}}])})],1),e("a-modal",{staticStyle:{top:"100px"},attrs:{title:"编辑商品SKU",visible:t.visible,width:"1000px"},on:{"update:visible":function(e){t.visible=e},ok:t.handleOk,cancel:function(e){t.visible=!1}}},[e("a-table",{staticClass:"modal-skus-table",attrs:{rowKey:function(t){return t.uuid},dataSource:t.skus,pagination:!1,size:"small",loading:t.getSkusLoading}},[e("a-table-column",{attrs:{title:"商品规格"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("span",[t._v(t._s(t.getAttrs(i.attrs)))])]}}])}),e("a-table-column",{key:"image",attrs:{title:"图片",width:"120px"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("UploadImages",{attrs:{size:"small"},model:{value:i.thumb,callback:function(e){t.$set(i,"thumb",e)},expression:"row.thumb"}})]}}])}),e("a-table-column",{attrs:{title:"编号",width:"120px"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("a-input",{attrs:{placeholder:"编号"},model:{value:i.number,callback:function(e){t.$set(i,"number",e)},expression:"row.number"}})]}}])}),e("a-table-column",{attrs:{title:"价格(人民币)",width:"120px"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("a-input",{attrs:{placeholder:"人民币价"},model:{value:i.money_price,callback:function(e){t.$set(i,"money_price",e)},expression:"row.money_price"}})]}}])}),e("a-table-column",{attrs:{title:"价格(积分)",width:"120px"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("a-input",{attrs:{placeholder:"积分价"},model:{value:i.score_price,callback:function(e){t.$set(i,"score_price",e)},expression:"row.score_price"}})]}}])}),e("a-table-column",{attrs:{title:"库存",width:"120px"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("a-input",{attrs:{placeholder:"库存"},model:{value:i.stock,callback:function(e){t.$set(i,"stock",e)},expression:"row.stock"}})]}}])}),e("a-table-column",{key:"sales",attrs:{title:"销量",width:"60px"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("span",[t._v("  "+t._s(i.sales))])]}}])}),e("a-table-column",{key:"status",attrs:{title:"是否上架",width:"120px"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("ISwitch",{attrs:{active:1,unactive:0},model:{value:i.status,callback:function(e){t.$set(i,"status",e)},expression:"row.status"}})]}}])})],1)],1),e("a-modal",{attrs:{title:"设置人群价",width:"1000px",footer:null,visible:t.isEditGroupPrice},on:{cancel:function(e){t.isEditGroupPrice=t.fetchData()||!1}}},[e("div",[t.isEditGroupPrice?e("EditGroupPrice",{attrs:{uuid:t.editUuid,type:"products"},on:{close:function(e){t.isEditGroupPrice=!1},refresh:t.fetchData}}):t._e()],1)]),e("BatchEdit",{attrs:{isShow:t.isBatchEdit},on:{hide:function(e){t.isBatchEdit=!1}}}),e("a-modal",{staticStyle:{top:"100px"},attrs:{title:"编辑商品信息",visible:t.visible2,width:"600px",confirmLoading:t.loading2},on:{"update:visible":function(e){t.visible2=e},ok:t.handleOk2,cancel:function(e){t.visible2=!1}}},[e("a-form",{attrs:{form:t.form}},[e("a-form-item",{attrs:{label:"标题","label-col":{span:4},"wrapper-col":{span:18}}},[e("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["title",{rules:[{required:!0,message:"请输入商品标题!"}]}],expression:"[\n\t\t\t  'title',\n\t\t\t  {rules: [{ required: true, message: '请输入商品标题!' }]}\n\t\t\t]"}],attrs:{placeholder:"请输入"}})],1),e("a-form-item",{attrs:{label:"编号","label-col":{span:4},"wrapper-col":{span:18}}},[e("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["number"],expression:"[\n\t\t\t  'number'\n\t\t\t]"}],attrs:{placeholder:"请输入"}})],1),e("a-form-item",{attrs:{label:"分类","label-col":{span:4},"wrapper-col":{span:18}}},[e("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["category_ids"],expression:"[\n\t\t\t  'category_ids'\n\t\t\t]"}],attrs:{mode:"multiple",placeholder:"请选择",allowClear:""}},[t._l(t.allCategoryList,(function(i){return[e("a-select-opt-group",{key:i.id},[e("span",{attrs:{slot:"label"},slot:"label"},[t._v(t._s(i.title))]),t._l(i.sub_categories,(function(i){return e("a-select-option",{key:i.id,attrs:{value:i.id}},[t._v(t._s(i.title))])}))],2)]}))],2)],1),e("a-form-item",{attrs:{label:"绑定角标","label-col":{span:4},"wrapper-col":{span:18}}},[e("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["image_tag_id"],expression:"[\n          'image_tag_id'\n        ]"}],attrs:{placeholder:"请选择",allowClear:""}},[t._l(t.imageTagList,(function(i){return[e("a-select-option",{key:i.id,attrs:{value:i.id}},[t._v(t._s(i.title))])]}))],2)],1),e("a-form-item",{attrs:{label:"备注","label-col":{span:4},"wrapper-col":{span:18}}},[e("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["remark"],expression:"[\n          'remark'\n        ]"}],attrs:{placeholder:"请输入"}})],1)],1)],1)],1)},n=[],s=(i("8e6e"),i("456d"),i("6b54"),i("ade3")),o=i("2909"),r=i("7971"),c=i("7cc6"),l=function(){var t=this,e=t._self._c;return e("div",{staticClass:"editor-content"},[e("a-table",{staticClass:"product-table",attrs:{rowKey:function(t){return t.uuid},dataSource:t.list,bordered:"",pagination:!1,size:"small"}},[e("a-table-column",{attrs:{title:"序号",width:"50px"},scopedSlots:t._u([{key:"default",fn:function(i,a,n){return[e("div",[t._v(t._s(n+1))])]}}])}),e("a-table-column",{attrs:{title:"图片",width:"100px"},scopedSlots:t._u([{key:"default",fn:function(t){return[e("img",{staticClass:"thumb",attrs:{src:t.thumb}})]}}])}),e("a-table-column",{attrs:{title:"标题",width:"160px"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("div",{staticClass:"title"},[t._v("\n          "+t._s(i.title)+"\n        ")]),e("div",{staticClass:"number"},[t._v("\n          "+t._s(i.number)+"\n        ")])]}}])}),e("a-table-column",{attrs:{title:"已兑换",width:"80px"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("span",[t._v("\n          "+t._s(i.cover_chip_count||0)+"\n        ")])]}}])}),e("a-table-column",{attrs:{title:"兑换开关",width:"80px"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("span",[e("i-switch",{attrs:{active:i.cover_chip_status||1,size:"small"},model:{value:i.cover_chip_status,callback:function(e){t.$set(i,"cover_chip_status",e)},expression:"row.cover_chip_status"}})],1)]}}])})],1),e("div",{staticClass:"btn-c"},[e("div",{staticStyle:{"flex-grow":"1"}}),e("a-button",{staticClass:"save",attrs:{type:"primary"},on:{click:t.handleSave}},[t._v("保存")]),e("a-button",{staticClass:"cancel",on:{click:t.handleCancel}},[t._v("关闭")])],1)],1)},u=[],d={components:{UploadImages:r["a"],iSwitch:c["a"]},props:{id:{type:String,default:function(){return""}}},data:function(){return{list:[],chipList:[]}},watch:{id:function(){this.initList()}},created:function(){this.initList()},methods:{initList:function(){var t=this;this.$http.get("skus",{params:{product_id:this.id}}).then((function(e){t.list=e.data.list})),this.$http.get("/chips").then((function(e){t.chipList=e.data.list}))},handleCreate:function(){var t=this;this.$http.post("/products/".concat(this.uuid,"/skus")).then((function(e){t.initList()}))},handleCancel:function(){this.$emit("refresh"),this.$emit("close")},handleSave:function(){var t=this;this.$http.post("/skus/batch",{type:"update",list:this.list}).then((function(e){t.$message.success("保存成功"),t.initList()}))},handleDelete:function(t){var e=this;this.$http.delete("/products/".concat(this.uuid,"/skus/").concat(t.uuid)).then((function(t){e.$message.success("删除成功"),e.initList()}))}}},p=d,f=(i("9a98"),i("2877")),h=Object(f["a"])(p,l,u,!1,null,"137c37d5",null),m=h.exports,g=function(){var t=this,e=t._self._c;return e("div",{staticClass:"editor-content"},[e("a-table",{staticClass:"product-table",attrs:{rowKey:function(t){return t.uuid},dataSource:t.list,bordered:"",pagination:!1,size:"small"}},[e("a-table-column",{attrs:{title:"序号",width:"50px"},scopedSlots:t._u([{key:"default",fn:function(i,a,n){return[e("div",[t._v(t._s(n+1))])]}}])}),e("a-table-column",{attrs:{title:"标题(显示在商品详情页)"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("div",[e("a-input",{staticStyle:{width:"160px","margin-right":"4px"},attrs:{placeholder:"如VIP专享价"},model:{value:i.title,callback:function(e){t.$set(i,"title",e)},expression:"row.title"}})],1)]}}])}),e("a-table-column",{attrs:{title:"人群",width:"200px"}}),e("a-table-column",{attrs:{title:"专享价"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("div",[e("IPrice",{staticStyle:{width:"100px","margin-right":"4px"},model:{value:i.money_price,callback:function(e){t.$set(i,"money_price",e)},expression:"row.money_price"}}),t._v("元 + "),e("a-input",{staticStyle:{width:"100px","margin-right":"4px"},model:{value:i.score_price,callback:function(e){t.$set(i,"score_price",t._n(e))},expression:"row.score_price"}}),t._v("积分\n        ")],1)]}}])}),e("a-table-column",{attrs:{title:"显示排序"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("div",[e("a-input",{staticStyle:{width:"100px","margin-right":"4px"},model:{value:i.list_weight,callback:function(e){t.$set(i,"list_weight",t._n(e))},expression:"row.list_weight"}})],1)]}}])}),e("a-table-column",{attrs:{title:"操作",width:"80px"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("a",{attrs:{href:"javascript:;"},on:{click:function(e){return t.handleDelete(i)}}},[t._v("删除")])]}}])})],1),e("div",{staticClass:"btn-c"},[e("a-button",{staticClass:"add",attrs:{type:"primary"},on:{click:t.handleCreate}},[t._v("\n      新增一行\n    ")]),e("div",{staticStyle:{"flex-grow":"1"}}),e("a-button",{staticClass:"save",attrs:{type:"primary"},on:{click:t.handleSave}},[t._v("保存")]),e("a-button",{staticClass:"cancel",on:{click:t.handleCancel}},[t._v("关闭")])],1)],1)},v=[],_=i("dd08"),y={components:{UploadImages:r["a"],iSwitch:c["a"],IPrice:_["a"]},props:{uuid:{type:String,default:function(){return""}},type:{type:String,default:function(){return""}}},data:function(){return{list:[],groupList:[]}},watch:{id:function(){this.initList()}},created:function(){this.initList()},methods:{initList:function(){var t=this;this.$http.get("/".concat(this.type,"/").concat(this.uuid,"/group-price")).then((function(e){t.list=e.data.list})),this.$http.get("/user-groups").then((function(e){t.groupList=e.data.list}))},handleCreate:function(){this.list.push({uuid:Math.random().toString(36).slice(-8),group_id:void 0,money_price:0,score_price:0,list_weight:100})},handleCancel:function(){this.$emit("refresh"),this.$emit("close")},handleSave:function(){var t=this;this.$http.post("/".concat(this.type,"/").concat(this.uuid,"/group-price"),{list:this.list}).then((function(e){t.$message.success("保存成功"),t.initList(),t.$emit("refresh"),t.$emit("close")}))},handleDelete:function(t){for(var e=0;e<this.list.length;e++)if(this.list[e].uuid===t.uuid){this.list.splice(e,1);break}}}},b=y,k=(i("b9d0"),Object(f["a"])(b,g,v,!1,null,"00332608",null)),w=k.exports,S=function(){var t=this,e=t._self._c;return e("a-modal",{staticStyle:{top:"100px"},attrs:{title:"指编辑商品",visible:t.isShow,width:"800px",okText:"关闭"},on:{ok:t.handleOk,cancel:t.handleCancel}},[e("IForm",{staticClass:"form-container",attrs:{formFrame:t.frame,formData:t.form},on:{"update:formData":function(e){t.form=e},"update:form-data":function(e){t.form=e}}}),t._v("\n  共查询到 "+t._s(t.itemTotal)+" 个商品\n\n  "),e("div",{staticStyle:{"margin-top":"30px"}},[e("a-button",{attrs:{type:"primary"},on:{click:t.editSearchKey}},[e("span",[t._v("修改搜索关键词")])])],1)],1)},x=[],C=(i("7514"),i("9fb0"),i("b0a5"));i("b30f");function $(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,a)}return i}function O(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?$(Object(i),!0).forEach((function(e){Object(s["a"])(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):$(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var L={components:{IForm:C["a"]},props:{isShow:{type:Boolean}},computed:{frame:function(){return[{title:"一级分类",key:"category1_id",type:"select",newline:!0,required:!0,options:this.category1List},{title:"二级分类",key:"category2_id",type:"select",newline:!0,required:!0,options:this.category2List}]},category2List:function(){var t=this,e=this.category1List.find((function(e){return e.id=t.form.category1_id}));return e?e.sub_categories:[]}},data:function(){return{form:{category1_id:void 0,category2_id:void 0},itemTotal:0,category1List:[]}},watch:{form:{handler:function(t,e){this.initList()},deep:!0}},mounted:function(){var t=this;this.initList(),this.$http("/normal/categories").then((function(e){e.data.list.map((function(t){return t.value=t.id,t.sub_categories.map((function(t){return t.value=t.id,t})),t})),t.category1List=e.data.list}))},methods:{editSearchKey:function(){var t=this;this.$iForm.show({frame:[{title:"搜索关键词",type:"textarea",tips:"80个字以内",key:"search_key",span:24,required:!0}],success:function(e){t.$http.post("/product/batch-edit",O({options:t.form,type:"update_search_key"},e)).then((function(e){t.$message.success("更新成功"),t.$iForm.hide()}))}})},initList:function(){var t=this;this.$http.post("/product/batch-edit/total",this.form).then((function(e){t.itemTotal=e.data.total}))},handleChange:function(t){t.file,t.fileList},handleOk:function(){this.$emit("hide")},handleCancel:function(){this.$emit("hide")}}},P=L,E=(i("bc5c"),Object(f["a"])(P,S,x,!1,null,"7002e1f3",null)),I=E.exports,j=i("c1df"),T=i.n(j);i("5118");function D(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,a)}return i}function F(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?D(Object(i),!0).forEach((function(e){Object(s["a"])(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):D(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var U={name:"Products",components:{UploadImages:r["a"],ISwitch:c["a"],EditCoverChip:m,EditGroupPrice:w,BatchEdit:I},data:function(){return{statusList:[{text:"上架中",key:"on_stock"},{text:"已下架",key:"off_stock"},{text:"已售罄",key:"sell_out"},{text:"标记的",key:"marked"}],loading:!1,loading2:!1,loading3:!1,list:[],actived:"on_stock",statusTotal:{on_stock:0,off_stock:0,sell_out:0,marked:0},page:1,per_page:8,total:0,categoryList:[],ipList:[],imageTagList:[],brands:[],keys:{category_id:void 0,key:"",brand_id:void 0,shop_id:void 0,status:"on_stock",number:void 0},visible:!1,visible2:!1,current:{},skus:[],getSkusLoading:!1,form:this.$form.createForm(this),timeout:null,listWeight:"",isEditCoverChip:!1,isEditGroupPrice:!1,editUuid:"",editId:"",isBatchEdit:!1}},computed:{pagination:function(){var t=this;return console.log(this.page),{defaultPageSize:this.per_page,defaultCurrent:this.page,total:this.total,onChange:function(e){t.page=e,t.fetchData()}}},allCategoryList:function(){return[{id:0,title:"所有IP",sub_categories:this.ipList}].concat(Object(o["a"])(this.categoryList))}},watch:{keys:{handler:function(t){this.page=1,this.fetchData()},deep:!0}},filters:{priceToFixed:function(t){return t?(t/100).toFixed(2):"0.00"},formatDate:function(t){return t?T()(t).format("YYYY-MM-DD hh:mm"):""}},created:function(){this.page=parseInt(localStorage.getItem("product_list_page")||1),localStorage.setItem("product_list_page",1),this.getCategoryList(),this.getImageTagList(),this.fetchData(),this.fetchTotalData()},methods:{markProduct:function(t){var e=this;this.$http.patch("/shop/products/".concat(t.uuid),{type:"mark"}).then((function(t){e.$message.success("保存成功"),e.fetchData(),e.fetchTotalData()}))},handleEditCoverChip:function(t){this.editUuid=t.uuid,this.editId=t.id,this.isEditCoverChip=!0},handleEditGroupPrice:function(t){this.editUuid=t.uuid,this.editId=t.id,this.isEditGroupPrice=!0},fetchTotalData:function(){var t=this;this.$http("/status-total/product").then((function(e){t.statusTotal=e.data.total}))},getPath:function(t){this.$getPathPopup.show({page:"/pages/productDetail/index",param:"uuid="+t.uuid})},currentChange:function(t){console.log(t),this.page=t.current,this.fetchData()},updateRewardAndBrokerage:function(t,e){var i=this;this.updateItem(t,e).then((function(t){i.$message.success("保存成功"),i.$iForm.hide(),i.fetchData()}))},updateItem:function(t,e){return this.$api.emit("product.update",t.uuid,F({},e))},handleUpdateListWeight:function(t){var e=this;this.loading3=!0,this.$api.emit("product.update",t.uuid,{list_weight:this.listWeight}).then((function(){e.fetchData(),e.listWeight=""})).finally((function(){e.loading3=!1})),t.visible=!0},handleDelete:function(t){var e=this;this.$confirm({title:"提示",content:"确认删除商品 “".concat(t.title,"” ？"),onOk:function(){return new Promise((function(i,a){e.$api.emit("product.destory",t.uuid).then((function(t){e.fetchData(),i()})).catch((function(t){a(t)}))}))}})},resetKeys:function(){this.keys={category_ids:void 0,key:"",brand_id:void 0,status:""}},handleEditProduct:function(t){localStorage.setItem("product_list_page",this.page),this.$router.push({name:"EditProduct",params:{uuid:t.uuid}})},handleOk2:function(){var t=this;this.form.validateFields((function(e,i){e||(t.loading2=!0,t.$api.emit("product.update",t.current.uuid,F(F({},i),{},{image_tag_id:i.image_tag_id||""})).then((function(){t.fetchData(),t.visible2=!1})).finally((function(){t.loading2=!1})))}))},handleEditBaseInfo:function(t){var e=this;this.visible2=!0,this.current=t,this.$nextTick((function(){var i=[];t.categories.forEach((function(t){i.push(t.id)})),e.form.setFields({title:{value:t.title},brand_id:{value:t.brand&&t.brand.id},number:{value:t.number},category_ids:{value:t.category_ids},image_tag_id:{value:t.image_tag_id},remark:{value:t.remark}})}))},productStatusChange:function(t,e){var i=this;this.loading=!0,this.$api.emit("product."+(1===t?"put_on":"put_off"),e.uuid).finally((function(){i.fetchData(),i.fetchTotalData()}))},refresh:function(){this.page=1,this.fetchData(),this.fetchTotalData()},getAttrs:function(t){var e=[];return t.forEach((function(t){e.push(t.value)})),e.join("，")},handleOk:function(){var t=this,e=[],i=!1;this.skus.forEach((function(t){e.push({id:t.id,uuid:t.uuid,number:t.number,money_price:100*t.money_price,score_price:t.score_price,stock:t.stock,thumb:t.thumb,status:t.status}),""!==t.price&&""!==t.stock||(i=!0)})),i?this.$info({title:"提示",content:"商品SKU价格和库存不能为空"}):(this.getSkusLoading=!0,this.$api.emit("product.sku.batch_update",e).then((function(){t.visible=!1})).finally((function(){t.getSkusLoading=!1,t.fetchData()})))},handleEditSkus:function(t){var e=this;this.current=JSON.parse(JSON.stringify(t)),this.visible=!0,this.getSkusLoading=!0,this.$api.emit("product.sku.list",{product_id:t.id}).then((function(t){console.log(t),t.data.list.forEach((function(t){t.money_price=t.money_price/100})),e.skus=t.data.list})).finally((function(){e.getSkusLoading=!1}))},getProductCategory:function(t){var e=[];return t.forEach((function(t){e.push(t.title)})),e.join("、")},onSearch:function(t){console.log(t)},plusProducts:function(){this.$router.push({path:"/product/release"})},getCategoryList:function(){var t=this;this.$http("/normal/categories","GET").then((function(e){t.categoryList=e.data.list})),this.$http("/ip/categories","GET").then((function(e){t.ipList=e.data.list}))},getImageTagList:function(){var t=this;this.$http("/image-tags","GET").then((function(e){t.imageTagList=e.data.list}))},getBrandList:function(){this.brands=this.$api.emit("brand.list")},getShopList:function(t){function e(){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(){var t=this;getShopList().then((function(e){t.shops=e.data.list}))})),fetchData:function(){var t=this;this.$api.emit("product.list",F({page:this.page,per_page:this.per_page},this.keys)).then((function(e){e.data.list.forEach((function(t){t.visible=!1})),t.list=e.data.list,t.total=e.data.item_total}))}}},z=U,G=(i("de5e"),Object(f["a"])(z,a,n,!1,null,"326ea503",null));e["default"]=G.exports},"6c7f":function(t,e,i){},"712d":function(t,e,i){},"8f54":function(t,e,i){},"9a98":function(t,e,i){"use strict";i("d43a")},b0a5:function(t,e,i){"use strict";var a=i("b6c9");e["a"]=a["a"]},b30f:function(t,e,i){"use strict";i.d(e,"c",(function(){return s})),i.d(e,"e",(function(){return o})),i.d(e,"d",(function(){return r})),i.d(e,"a",(function(){return c})),i.d(e,"b",(function(){return l}));var a=i("b775"),n="/orders";function s(t,e){return Object(a["b"])({url:"".concat(n,"/").concat(t),method:"patch",data:{type:"deliver",deliver_info:e}})}function o(t,e){return Object(a["b"])({url:"".concat(n,"/").concat(t),method:"patch",data:{type:"update_seller_remark",seller_remark:e}})}function r(t,e){return Object(a["b"])({url:"".concat(n,"/").concat(t),method:"patch",data:{type:"update_address",address:e}})}function c(t){return Object(a["b"])({url:"/export/orders",method:"post",data:t})}function l(){return Object(a["b"])({url:"/express-list",method:"get"})}},b9d0:function(t,e,i){"use strict";i("6c7f")},bc5c:function(t,e,i){"use strict";i("712d")},d43a:function(t,e,i){},de5e:function(t,e,i){"use strict";i("8f54")}}]);