(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3143d4fc"],{"00d8":function(t,e){(function(){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n={rotl:function(t,e){return t<<e|t>>>32-e},rotr:function(t,e){return t<<32-e|t>>>e},endian:function(t){if(t.constructor==Number)return 16711935&n.rotl(t,8)|4278255360&n.rotl(t,24);for(var e=0;e<t.length;e++)t[e]=n.endian(t[e]);return t},randomBytes:function(t){for(var e=[];t>0;t--)e.push(Math.floor(256*Math.random()));return e},bytesToWords:function(t){for(var e=[],n=0,r=0;n<t.length;n++,r+=8)e[r>>>5]|=t[n]<<24-r%32;return e},wordsToBytes:function(t){for(var e=[],n=0;n<32*t.length;n+=8)e.push(t[n>>>5]>>>24-n%32&255);return e},bytesToHex:function(t){for(var e=[],n=0;n<t.length;n++)e.push((t[n]>>>4).toString(16)),e.push((15&t[n]).toString(16));return e.join("")},hexToBytes:function(t){for(var e=[],n=0;n<t.length;n+=2)e.push(parseInt(t.substr(n,2),16));return e},bytesToBase64:function(t){for(var n=[],r=0;r<t.length;r+=3)for(var a=t[r]<<16|t[r+1]<<8|t[r+2],o=0;o<4;o++)8*r+6*o<=8*t.length?n.push(e.charAt(a>>>6*(3-o)&63)):n.push("=");return n.join("")},base64ToBytes:function(t){t=t.replace(/[^A-Z0-9+\/]/gi,"");for(var n=[],r=0,a=0;r<t.length;a=++r%4)0!=a&&n.push((e.indexOf(t.charAt(r-1))&Math.pow(2,-2*a+8)-1)<<2*a|e.indexOf(t.charAt(r))>>>6-2*a);return n}};t.exports=n})()},5432:function(t,e,n){},"6821f":function(t,e,n){(function(){var e=n("00d8"),r=n("9a63").utf8,a=n("8349"),o=n("9a63").bin,i=function(t,n){t.constructor==String?t=n&&"binary"===n.encoding?o.stringToBytes(t):r.stringToBytes(t):a(t)?t=Array.prototype.slice.call(t,0):Array.isArray(t)||t.constructor===Uint8Array||(t=t.toString());for(var s=e.bytesToWords(t),c=8*t.length,u=1732584193,l=-271733879,f=-1732584194,p=271733878,d=0;d<s.length;d++)s[d]=16711935&(s[d]<<8|s[d]>>>24)|4278255360&(s[d]<<24|s[d]>>>8);s[c>>>5]|=128<<c%32,s[14+(c+64>>>9<<4)]=c;var h=i._ff,m=i._gg,v=i._hh,g=i._ii;for(d=0;d<s.length;d+=16){var y=u,b=l,w=f,_=p;u=h(u,l,f,p,s[d+0],7,-680876936),p=h(p,u,l,f,s[d+1],12,-389564586),f=h(f,p,u,l,s[d+2],17,606105819),l=h(l,f,p,u,s[d+3],22,-1044525330),u=h(u,l,f,p,s[d+4],7,-176418897),p=h(p,u,l,f,s[d+5],12,1200080426),f=h(f,p,u,l,s[d+6],17,-1473231341),l=h(l,f,p,u,s[d+7],22,-45705983),u=h(u,l,f,p,s[d+8],7,1770035416),p=h(p,u,l,f,s[d+9],12,-1958414417),f=h(f,p,u,l,s[d+10],17,-42063),l=h(l,f,p,u,s[d+11],22,-1990404162),u=h(u,l,f,p,s[d+12],7,1804603682),p=h(p,u,l,f,s[d+13],12,-40341101),f=h(f,p,u,l,s[d+14],17,-1502002290),l=h(l,f,p,u,s[d+15],22,1236535329),u=m(u,l,f,p,s[d+1],5,-165796510),p=m(p,u,l,f,s[d+6],9,-1069501632),f=m(f,p,u,l,s[d+11],14,643717713),l=m(l,f,p,u,s[d+0],20,-373897302),u=m(u,l,f,p,s[d+5],5,-701558691),p=m(p,u,l,f,s[d+10],9,38016083),f=m(f,p,u,l,s[d+15],14,-660478335),l=m(l,f,p,u,s[d+4],20,-405537848),u=m(u,l,f,p,s[d+9],5,568446438),p=m(p,u,l,f,s[d+14],9,-1019803690),f=m(f,p,u,l,s[d+3],14,-187363961),l=m(l,f,p,u,s[d+8],20,1163531501),u=m(u,l,f,p,s[d+13],5,-1444681467),p=m(p,u,l,f,s[d+2],9,-51403784),f=m(f,p,u,l,s[d+7],14,1735328473),l=m(l,f,p,u,s[d+12],20,-1926607734),u=v(u,l,f,p,s[d+5],4,-378558),p=v(p,u,l,f,s[d+8],11,-2022574463),f=v(f,p,u,l,s[d+11],16,1839030562),l=v(l,f,p,u,s[d+14],23,-35309556),u=v(u,l,f,p,s[d+1],4,-1530992060),p=v(p,u,l,f,s[d+4],11,1272893353),f=v(f,p,u,l,s[d+7],16,-155497632),l=v(l,f,p,u,s[d+10],23,-1094730640),u=v(u,l,f,p,s[d+13],4,681279174),p=v(p,u,l,f,s[d+0],11,-358537222),f=v(f,p,u,l,s[d+3],16,-722521979),l=v(l,f,p,u,s[d+6],23,76029189),u=v(u,l,f,p,s[d+9],4,-640364487),p=v(p,u,l,f,s[d+12],11,-421815835),f=v(f,p,u,l,s[d+15],16,530742520),l=v(l,f,p,u,s[d+2],23,-995338651),u=g(u,l,f,p,s[d+0],6,-198630844),p=g(p,u,l,f,s[d+7],10,1126891415),f=g(f,p,u,l,s[d+14],15,-1416354905),l=g(l,f,p,u,s[d+5],21,-57434055),u=g(u,l,f,p,s[d+12],6,1700485571),p=g(p,u,l,f,s[d+3],10,-1894986606),f=g(f,p,u,l,s[d+10],15,-1051523),l=g(l,f,p,u,s[d+1],21,-2054922799),u=g(u,l,f,p,s[d+8],6,1873313359),p=g(p,u,l,f,s[d+15],10,-30611744),f=g(f,p,u,l,s[d+6],15,-1560198380),l=g(l,f,p,u,s[d+13],21,1309151649),u=g(u,l,f,p,s[d+4],6,-145523070),p=g(p,u,l,f,s[d+11],10,-1120210379),f=g(f,p,u,l,s[d+2],15,718787259),l=g(l,f,p,u,s[d+9],21,-343485551),u=u+y>>>0,l=l+b>>>0,f=f+w>>>0,p=p+_>>>0}return e.endian([u,l,f,p])};i._ff=function(t,e,n,r,a,o,i){var s=t+(e&n|~e&r)+(a>>>0)+i;return(s<<o|s>>>32-o)+e},i._gg=function(t,e,n,r,a,o,i){var s=t+(e&r|n&~r)+(a>>>0)+i;return(s<<o|s>>>32-o)+e},i._hh=function(t,e,n,r,a,o,i){var s=t+(e^n^r)+(a>>>0)+i;return(s<<o|s>>>32-o)+e},i._ii=function(t,e,n,r,a,o,i){var s=t+(n^(e|~r))+(a>>>0)+i;return(s<<o|s>>>32-o)+e},i._blocksize=16,i._digestsize=16,t.exports=function(t,n){if(void 0===t||null===t)throw new Error("Illegal argument "+t);var r=e.wordsToBytes(i(t,n));return n&&n.asBytes?r:n&&n.asString?o.bytesToString(r):e.bytesToHex(r)}})()},7761:function(t,e,n){"use strict";n("5432")},8349:function(t,e){function n(t){return!!t.constructor&&"function"===typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}function r(t){return"function"===typeof t.readFloatLE&&"function"===typeof t.slice&&n(t.slice(0,0))}
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
t.exports=function(t){return null!=t&&(n(t)||r(t)||!!t._isBuffer)}},"9a63":function(t,e){var n={utf8:{stringToBytes:function(t){return n.bin.stringToBytes(unescape(encodeURIComponent(t)))},bytesToString:function(t){return decodeURIComponent(escape(n.bin.bytesToString(t)))}},bin:{stringToBytes:function(t){for(var e=[],n=0;n<t.length;n++)e.push(255&t.charCodeAt(n));return e},bytesToString:function(t){for(var e=[],n=0;n<t.length;n++)e.push(String.fromCharCode(t[n]));return e.join("")}}};t.exports=n},cbd3:function(t,e,n){"use strict";n.r(e);n("7f7f");var r=function(){var t=this,e=t._self._c;return e("div",{staticClass:"content-wrap"},[e("div",{staticStyle:{"margin-bottom":"20px"}},[e("a-button",{attrs:{type:"primary",icon:"plus"},on:{click:t.plusAdmins}},[t._v("添加管理员")])],1),e("a-table",{staticClass:"table",attrs:{rowKey:function(t){return t.uuid},dataSource:t.list,pagination:t.pagination,loading:t.loading}},[e("a-table-column",{key:"name",attrs:{title:"名称",dataIndex:"name"}}),e("a-table-column",{key:"phone",attrs:{title:"手机号",dataIndex:"phone"}}),e("a-table-column",{key:"roles",attrs:{title:"角色",dataIndex:"roles"},scopedSlots:t._u([{key:"default",fn:function(n){return[e("span",[t._v(t._s(t.getRolesText(n)))])]}}])}),e("a-table-column",{key:"last_active_at",attrs:{title:"最后活跃",dataIndex:"last_active_at"},scopedSlots:t._u([{key:"default",fn:function(n){return[e("span",[t._v(t._s(t._f("formatDate")(n)))])]}}])}),e("a-table-column",{key:"action",attrs:{title:"操作"},scopedSlots:t._u([{key:"default",fn:function(n){return[e("span",[e("a",{attrs:{href:"javascript:;"},on:{click:function(e){return t.handleResetPassword(n)}}},[t._v("重设密码")]),e("a-divider",{attrs:{type:"vertical"}}),e("a",{attrs:{href:"javascript:;"},on:{click:function(e){return t.handleEdit(n)}}},[t._v("编辑")]),e("a-divider",{attrs:{type:"vertical"}}),e("a",{attrs:{href:"javascript:;"},on:{click:function(e){return t.handleDlete(n)}}},[t._v("删除")])],1)]}}])})],1),e("a-modal",{staticStyle:{top:"100px"},attrs:{title:t.actionTitle,visible:t.visible,width:"600px"},on:{ok:t.handleOk,cancel:t.handleCancel}},[e("a-form",{attrs:{form:t.form}},[e("a-form-item",{attrs:{label:"名称","label-col":{span:5},"wrapper-col":{span:12}}},[e("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{rules:[{required:!0,message:"请输入名称"}]}],expression:"[\n            'name',\n            {rules: [{ required: true, message: '请输入名称' }]}\n          ]"}]})],1),e("a-form-item",{attrs:{label:"手机号","label-col":{span:5},"wrapper-col":{span:12}}},[e("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["phone",{rules:[{required:!0,message:"请输入手机号"}]}],expression:"[\n            'phone',\n            {rules: [{ required: true, message: '请输入手机号' }]}\n          ]"}]})],1),0===t.actionType?e("a-form-item",{attrs:{label:"密码","label-col":{span:5},"wrapper-col":{span:12}}},[e("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["password",{rules:[{required:!0,message:"请输入密码"}]}],expression:"[\n            'password',\n            {rules: [{ required: true, message: '请输入密码' }]}\n          ]"}],attrs:{type:"password"}})],1):t._e(),e("a-form-item",{attrs:{label:"角色","label-col":{span:5},"wrapper-col":{span:12}}},[e("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["roles",{rules:[{required:!0,message:"请选择管理员角色"}]}],expression:"[\n            'roles',\n            {rules: [{ required: true, message: '请选择管理员角色' }]}\n          ]"}],attrs:{mode:"multiple",placeholder:"选择角色"}},t._l(t.roleList,(function(n){return e("a-select-option",{key:n.id,attrs:{value:n.id}},[t._v("\n            "+t._s(n.name)+"\n          ")])})),1)],1)],1)],1)],1)},a=[],o=(n("8e6e"),n("456d"),n("ac6a"),n("ade3")),i=n("6821f"),s=n.n(i),c=n("c1df"),u=n.n(c);function l(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function f(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?l(Object(n),!0).forEach((function(e){Object(o["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var p={name:"Admins",data:function(){return{loading:!1,list:[],page:1,per_page:10,total:0,visible:!1,form:this.$form.createForm(this),checkedList:[],current:{},roleList:[],actionType:0}},computed:{pagination:function(){var t=this;return{defaultPageSize:this.per_page,defaultCurrent:this.page,total:this.total,onChange:function(e){t.page=e,t.fetch()}}},actionTitle:function(){return 0===this.actionType?"创建管理员":"编辑管理员"}},filters:{formatDate:function(t){return t?u()(t).fromNow():""}},created:function(){var t=this;this.fetch(),this.$api.emit("admin.role.list").then((function(e){t.roleList=e.data.list}))},methods:{handleResetPassword:function(t){var e=this;this.$iForm.show({title:"重设管理员密码",frame:[{type:"password",title:"新密码",key:"password",required:!0,placeholder:"6位长度以上"},{type:"password",title:"确认新密码",key:"password_repeat",required:!0,placeholder:"6位长度以上"}],success:function(n){if(n.password!==n.password_repeat)return e.$message.error("两次输入的密码不一致"),!1;e.$http.patch("/admins/".concat(t.uuid),f({type:"reset_password"},n)).then((function(t){e.$message.success("操作成功"),e.$iForm.hide(),e.fetchData()}))}})},handleDlete:function(t){var e=this;this.$confirm({title:"提示",content:"确认删除管理员 “".concat(t.name,"” ？"),onOk:function(){return new Promise((function(n,r){e.$api.emit("admin.destory",t.uuid).then((function(t){e.fetch(),n()})).catch((function(t){r(t)}))}))}})},handleEdit:function(t){var e=this;this.visible=!0,this.actionType=1,this.current=t,this.$nextTick((function(){var n=[];t.roles.forEach((function(t){n.push(t.id)})),e.form.setFields({name:{value:t.name},phone:{value:t.phone},roles:{value:n}})}))},getRolesText:function(t){var e=[];return t.forEach((function(t){e.push(t.name)})),e.join("、")},handleOk:function(){var t=this,e=0===this.actionType?["name","password","phone","roles"]:["name","phone","roles"];this.form.validateFields(e,{force:!0},(function(e,n){if(!e){var r={name:n.name,phone:n.phone,roles:n.roles};0===t.actionType?(r.password=s()(n.password),t.$api.emit("admin.store",r).then((function(e){t.visible=!1,t.fetch()}))):t.$api.emit("admin.update",t.current.uuid,r).then((function(e){t.visible=!1,t.fetch()}))}}))},handleCancel:function(){this.visible=!1},plusAdmins:function(){this.visible=!0,this.actionType=0,this.checkedList=[],this.form.resetFields()},fetch:function(){var t=this;this.loading=!0,this.$api.emit("admin.list",{page:this.page,per_page:this.per_page}).then((function(e){t.list=e.data.list,t.total=e.data.item_total})).finally((function(){t.loading=!1}))}}},d=p,h=(n("7761"),n("2877")),m=Object(h["a"])(d,r,a,!1,null,"93a357be",null);e["default"]=m.exports}}]);