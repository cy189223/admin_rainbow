(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-143a449d"],{"1f10":function(t,e,a){},4586:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t._self._c;return e("div",{staticClass:"content-wrap"},[e("div",{staticClass:"header-action",staticStyle:{"margin-bottom":"20px"}},[e("a-button",{attrs:{type:"primary",icon:"plus"},on:{click:t.handlePlus}},[t._v("添加分类")]),e("a-input-search",{staticStyle:{width:"200px"},attrs:{placeholder:"输入关键字"},on:{search:t.onSearch}})],1),e("a-table",{staticClass:"table",attrs:{rowKey:function(t){return t.uuid},dataSource:t.list,pagination:t.pagination,loading:t.loading},scopedSlots:t._u([{key:"expandedRowRender",fn:function(a){return e("a-table",{staticClass:"expanded-table",attrs:{rowKey:function(t){return t.uuid},dataSource:a.sub_categories,pagination:!1}},[e("a-table-column",{key:"childTitle",attrs:{title:"子分类",dataIndex:"title"}}),e("a-table-column",{key:"thumb",attrs:{title:"图片"},scopedSlots:t._u([{key:"default",fn:function(t){return[e("img",{staticClass:"thumb",attrs:{src:t.thumb,alt:""}})]}}],null,!0)}),e("a-table-column",{key:"sub_products_count",attrs:{title:"商品数量"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v(t._s(a.products_count))])]}}],null,!0)}),e("a-table-column",{key:"childAction",attrs:{title:"操作"},scopedSlots:t._u([{key:"default",fn:function(n){return[e("span",[e("a",{attrs:{href:"javascript:;"},on:{click:function(e){return t.handleEdit(n,a.id)}}},[t._v("编辑")]),e("a-divider",{attrs:{type:"vertical"}}),e("a",{attrs:{href:"javascript:;"},on:{click:function(e){return t.handleDlete(n,a.id)}}},[t._v("删除")])],1)]}}],null,!0)})],1)}}])},[e("a-table-column",{key:"title",attrs:{title:"分类标题",dataIndex:"title"}}),e("a-table-column",{key:"thumb",attrs:{title:"图片"},scopedSlots:t._u([{key:"default",fn:function(t){return[e("img",{staticClass:"thumb",attrs:{src:t.thumb,alt:""}})]}}])}),e("a-table-column",{key:"children",attrs:{title:"子分类"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v(t._s(a.sub_categories.length))])]}}])}),e("a-table-column",{key:"products_count",attrs:{title:"商品数量"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v(t._s(a.products_count))])]}}])}),e("a-table-column",{key:"is_home",attrs:{title:"是否推送到商城首页"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("ISwitch",{attrs:{value:a.is_home,active:1,unactive:0},on:{change:function(e){return t.statusChange(e,a)}}})]}}])}),e("a-table-column",{key:"action",attrs:{title:"操作"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[e("a",{attrs:{href:"javascript:;"},on:{click:function(e){return t.handleEdit(a)}}},[t._v("编辑")]),e("a-divider",{attrs:{type:"vertical"}}),e("a",{attrs:{href:"javascript:;"},on:{click:function(e){return t.handleDlete(a)}}},[t._v("删除")])],1)]}}])})],1),e("a-modal",{staticStyle:{top:"100px"},attrs:{title:t.actionTitle,visible:t.visible,width:"600px"},on:{ok:t.handleOk,cancel:t.handleCancel}},[e("a-form",{attrs:{form:t.form}},[e("a-form-item",{attrs:{label:"标题","label-col":{span:5},"wrapper-col":{span:12}}},[e("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["title",{rules:[{required:!0,message:"请输入标题"}]}],expression:"[\n            'title',\n            {rules: [{ required: true, message: '请输入标题' }]}\n          ]"}],attrs:{placeholder:"请输入"}})],1),e("a-form-item",{attrs:{label:"副标题","label-col":{span:5},"wrapper-col":{span:12}}},[e("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["sub_title"],expression:"[\n            'sub_title'\n          ]"}],attrs:{placeholder:"请输入"}})],1),e("a-form-item",{attrs:{label:"封面图","label-col":{span:5}}},[e("upload-images",{attrs:{tips:"建议尺寸: 400 * 400",size:"small"},model:{value:t.thumb,callback:function(e){t.thumb=e},expression:"thumb"}})],1),e("a-form-item",{attrs:{label:"父分类","label-col":{span:5},"wrapper-col":{span:12}}},[e("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["parent_id"],expression:"[\n            'parent_id'\n          ]"}],attrs:{placeholder:"空时为一级分类",allowClear:""}},t._l(t.list,(function(a){return e("a-select-option",{key:a.id,attrs:{value:a.id}},[t._v("\n            "+t._s(a.title)+"\n          ")])})),1)],1)],1)],1)],1)},i=[],l=a("7971"),s=a("7cc6"),r={name:"Category",components:{UploadImages:l["a"],ISwitch:s["a"]},data:function(){return{loading:!1,list:[],page:1,per_page:10,total:0,visible:!1,form:this.$form.createForm(this),thumb:"",current:{},actionType:0}},computed:{pagination:function(){return{defaultPageSize:this.per_page,defaultCurrent:this.page,total:this.total}},actionTitle:function(){return 0===this.actionType?"创建分类":"编辑分类"}},created:function(){this.fetch()},methods:{statusChange:function(t,e){var a=this;this.loading=!0,this.$api.emit("category.update",e.uuid,{is_home:t}).then((function(t){a.fetch()}))},onSearch:function(t){console.log(t)},handleDlete:function(t){var e=this;this.$confirm({title:"提示",content:"确认删除分类 “".concat(t.title,"” ？"),onOk:function(){e.$api.emit("category.destory",t.uuid).then((function(t){e.fetch()}))}})},handleEdit:function(t,e){var a=this;this.visible=!0,this.actionType=1,this.current=t,this.$nextTick((function(){a.form.setFields({title:{value:t.title},parent_id:{value:e||""},sub_title:{value:t.sub_title||""}}),a.thumb=t.thumb}))},handleOk:function(){var t=this;this.form.validateFields((function(e,a){if(!e){var n={title:a.title,parent_id:a.parent_id,sub_title:a.sub_title,thumb:t.thumb};0===t.actionType?t.$api.emit("category.store",n).then((function(e){t.visible=!1,t.fetch()})):t.$api.emit("category.update",t.current.uuid,n).then((function(e){t.visible=!1,t.fetch()}))}}))},handleCancel:function(){this.visible=!1},handlePlus:function(){this.visible=!0,this.actionType=0,this.thumb="",this.form.resetFields()},fetch:function(){var t=this;this.loading=!0,this.$api.emit("category.list",{page:this.page,per_page:this.per_page}).then((function(e){t.list=e.data.list,t.total=e.data.item_total})).finally((function(){t.loading=!1}))}}},o=r,c=(a("fe35"),a("2877")),u=Object(c["a"])(o,n,i,!1,null,"d2d23ea6",null);e["default"]=u.exports},fe35:function(t,e,a){"use strict";a("1f10")}}]);