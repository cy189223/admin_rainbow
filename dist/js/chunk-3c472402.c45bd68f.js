(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3c472402"],{2612:function(t,e,a){"use strict";a.d(e,"a",(function(){return r})),a.d(e,"b",(function(){return o}));var n=a("b775"),i="/users";function r(t){return Object(n["b"])({url:i,method:"get",params:t})}function o(t,e){return Object(n["b"])({url:"".concat(i,"/").concat(e),method:"patch",data:{type:"update",attributes:t}})}},"447d":function(t,e,a){"use strict";a("784e")},"55dd":function(t,e,a){"use strict";var n=a("5ca1"),i=a("d8e8"),r=a("4bf8"),o=a("79e5"),s=[].sort,c=[1,2,3];n(n.P+n.F*(o((function(){c.sort(void 0)}))||!o((function(){c.sort(null)}))||!a("2f21")(s)),"Array",{sort:function(t){return void 0===t?s.call(r(this)):s.call(r(this),i(t))}})},"784e":function(t,e,a){},"95c7":function(t,e,a){"use strict";a.r(e);a("7f7f");var n=function(){var t=this,e=t._self._c;return e("div",{staticClass:"user-list"},[e("div",{staticClass:"content-head",staticStyle:{"margin-bottom":"20px"}},[e("div",{staticClass:"sort-keys"},[e("a-input",{staticStyle:{width:"180px","margin-right":"10px"},attrs:{placeholder:"输入关键字",allowClear:""},on:{input:t.onSearch},model:{value:t.key,callback:function(e){t.key=e},expression:"key"}}),e("a-button",{staticStyle:{"margin-right":"10px"},attrs:{type:"primary"},on:{click:t.refresh}},[t._v("刷新")])],1)]),e("a-table",{staticClass:"table",attrs:{rowKey:function(t){return t.uuid},dataSource:t.list,pagination:t.pagination,loading:t.loading},on:{change:t.onPaginationChange}},[e("a-table-column",{key:"name",attrs:{title:"姓名",width:"150px"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("div",{staticClass:"user"},[e("img",{attrs:{src:a.headimg,alt:"用户头像"}}),e("span",[t._v(t._s(a.name))]),"男"===a.gender?e("a-icon",{staticClass:"gender-man",attrs:{type:"man"}}):e("a-icon",{staticClass:"gender-woman",attrs:{type:"woman"}}),"ali"===a.client_type?e("a-tag",{staticStyle:{"margin-left":"10px"},attrs:{color:"red"}},[t._v("天猫用户")]):t._e()],1)]}}])}),e("a-table-column",{attrs:{title:"VIP期限",width:"120px"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("div",[t._v(t._s(t.$tool.formatDate(a.vip_start_at,"yyyy-MM-dd")))]),e("div",[t._v(t._s(t.$tool.formatDate(a.vip_end_at,"yyyy-MM-dd")))])]}}])}),e("a-table-column",{key:"phone",attrs:{title:"手机号",dataIndex:"phone",width:"80px"}}),e("a-table-column",{key:"address",attrs:{title:"地区",dataIndex:"city",width:"60px"}}),e("a-table-column",{key:"name",attrs:{title:"邀请人",width:"150px"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("div",{staticClass:"user"},[a.inviter?e("div",[e("img",{attrs:{src:a.inviter.headimg,alt:"用户头像"}}),t._v("\n              "+t._s(a.inviter.name)+"\n            ")]):e("div",[t._v("-")])])]}}])}),e("a-table-column",{key:"name",attrs:{title:"邀请数",width:"70px"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("div",[t._v(t._s(a.invitees_count)+"人")])]}}])}),e("a-table-column",{key:"score",attrs:{title:"积分",dataIndex:"score",width:"70px"}}),e("a-table-column",{key:"redpack",attrs:{title:"红包",width:"80px"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("div",[t._v(t._s(a.redpack/100)+"元")])]}}])}),e("a-table-column",{key:"created_at",attrs:{title:"注册日期",dataIndex:"created_at",width:"100px"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v(t._s(t._f("formatDate2")(a)))])]}}])}),e("a-table-column",{key:"last_active_at",attrs:{title:"最后活跃",dataIndex:"last_active_at",width:"80px"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v(t._s(t._f("formatDate")(a)))])]}}])}),e("a-table-column",{key:"action",attrs:{title:"操作",width:"60px"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v("\n\t\t\t  -\n            ")])]}}])})],1),e("a-modal",{staticStyle:{top:"100px"},attrs:{title:"编辑用户信息",visible:t.visible,width:"600px",confirmLoading:t.confirmLoading},on:{ok:t.handleOk,cancel:function(e){t.visible=!1}}},[e("a-form",{attrs:{form:t.form}},[e("a-form-item",{attrs:{label:"用户名","label-col":{span:5},"wrapper-col":{span:12}}},[e("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{rules:[{required:!0,message:"请输入用户名"}]}],expression:"[\n              'name',\n              {rules: [{ required: true, message: '请输入用户名' }]}\n            ]"}],attrs:{placeholder:"请输入"}})],1),e("a-form-item",{attrs:{label:"手机号","label-col":{span:5},"wrapper-col":{span:12}}},[e("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["phone",{rules:[{pattern:/^1[34578]\d{9}$/,message:"请输入正确的手机号"}],validateTrigger:"change"}],expression:"[\n              'phone',\n              {rules: [{ pattern: /^1[34578]\\d{9}$/, message: '请输入正确的手机号' }], validateTrigger: 'change'}\n            ]"}],attrs:{placeholder:"请输入"}})],1),e("a-form-item",{attrs:{label:"地区","label-col":{span:5},"wrapper-col":{span:12}}},[e("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["city"],expression:"[\n              'city'\n            ]"}],attrs:{placeholder:"请输入"}})],1)],1)],1)],1)},i=[],r=(a("8e6e"),a("ac6a"),a("456d"),a("55dd"),a("ade3")),o=a("2612"),s=a("c1df"),c=a.n(s);function l(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function u(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?l(Object(a),!0).forEach((function(e){Object(r["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var d={name:"UserList",data:function(){return{loading:!1,list:[],page:1,per_page:10,total:0,key:"",sort:"time",form:this.$form.createForm(this),visible:!1,confirmLoading:!1,timeout:null}},computed:{pagination:function(){return{defaultPageSize:this.per_page,defaultCurrent:this.page,total:this.total,showTotal:function(t){return"共 ".concat(t," 条")}}}},filters:{formatDate:function(t){return t?c()(t).fromNow():""},formatDate2:function(t){return t?c()(t).format("YYYY-MM-DD"):""}},created:function(){this.fetchData()},watch:{sort:function(t){this.fetchData()}},methods:{onPaginationChange:function(t){this.page=t.current,this.per_page=t.pageSize,this.fetchData()},refresh:function(){this.page=1,this.key="",this.fetchData()},onSearch:function(t){var e=this;clearTimeout(this.timeout),this.timeout=setTimeout((function(){e.fetchData()}),300)},handleAddScore:function(t){var e=this;this.$globalForm.show({title:"为用户添加积分",items:[{type:"number",key:"score",title:"增加数量",required:!0},{type:"text",key:"description",title:"描述",required:!0}],success:function(a){e.$http({url:"/users/".concat(t.uuid,"/score"),method:"PATCH",data:u({type:"add"},a)}).then((function(t){e.$message.success("操作成功"),e.$globalForm.hide(),e.fetchData()}))}})},handleEdit:function(t){var e=this;this.current=t,this.visible=!0,this.$nextTick((function(){e.form.setFields({name:{value:t.name},phone:{value:t.phone},city:{value:t.city}})}))},handleOk:function(){var t=this;this.form.validateFields((function(e,a){e||(t.confirmLoading=!0,Object(o["b"])(a,t.current.uuid).then((function(e){t.visible=!1,t.fetchData()})).finally((function(){t.confirmLoading=!1})))}))},fetchData:function(){var t=this;this.loading=!0,this.$http("/vip-users","GET",{page:this.page,per_page:this.per_page,key:this.key,sort:this.sort}).then((function(e){t.list=e.data.list,t.total=e.data.item_total})).finally((function(){t.loading=!1}))}}},p=d,f=(a("447d"),a("2877")),h=Object(f["a"])(p,n,i,!1,null,"36c9cff7",null);e["default"]=h.exports}}]);